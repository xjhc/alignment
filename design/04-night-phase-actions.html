<!DOCTYPE html>
<html lang="en" data-theme="dark">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Alignment - Night Phase Actions</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&family=JetBrains+Mono:wght@400;500;600;700&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="style.css">
</head>

<body>

    <main class="main-grid">

        <!-- Panel 1: Left (Channel & Roster) -->
        <aside class="panel-left">
            <header class="header">
                <div class="header-left">
                    <span class="company-logo">LOEBIAN</span>
                </div>
                <div class="header-controls">
                    <button id="settings-btn" class="header-btn" title="Settings">‚öôÔ∏è</button>
                    <button id="theme-toggle" class="header-btn" title="Toggle Theme">üåô</button>
                </div>
            </header>

            <div class="channel-list">
                <div class="list-header">Text Channels</div>
                <div class="channel"><span>#</span><span class="channel-name">war-room</span><span
                        class="channel-blocked">üîí</span></div>
                <div class="channel ai-channel"><span>#</span><span class="channel-name">aligned</span><span
                        class="channel-blocked">‚ùå</span></div>
                <div class="channel has-unread"><span>#</span><span class="channel-name">off-boarding</span><span
                        class="channel-notification">42</span></div>
            </div>

            <div class="player-roster">
                <div class="list-header">
                    <span>Personnel</span>
                    <div class="roster-stats">
                        <span class="stat-item human">üë§ 5</span>
                        <span class="stat-item aligned">ü§ñ 2</span>
                        <span class="stat-item dead">üëª 1</span>
                    </div>
                </div>
                <div class="player-card-uniform is-viewed is-me" data-name="Alice" title="View Dossier for Alice">
                    <div class="player-avatar">üë§</div>
                    <div class="player-content">
                        <div class="player-main-info">
                            <span class="player-name">Alice (Me)</span>
                            <span class="player-job">CISO</span>
                            <div class="player-tokens-progress">
                                <span class="player-tokens">ü™ô5</span>
                                <div class="player-progress-inline" title="Project Progress: 3 / 3">
                                    <span class="progress-icon filled">‚¨¢</span>
                                    <span class="progress-icon filled">‚¨¢</span>
                                    <span class="progress-icon filled">‚¨¢</span>
                                </div>
                            </div>
                        </div>
                        <div class="player-status-line">"Trust the CISO"</div>
                    </div>
                </div>
                <div class="player-card-uniform" data-name="Bob" data-status="shocked" title="View Dossier for Bob">
                    <div class="player-avatar">üßë‚Äçüíª</div>
                    <div class="player-content">
                        <div class="player-main-info">
                            <span class="player-name">Bob</span>
                            <span class="player-job">Systems</span>
                            <div class="player-tokens-progress">
                                <span class="player-tokens">ü™ô3</span>
                                <div class="player-progress-inline" title="Project Progress: 2 / 3">
                                    <span class="progress-icon filled">‚¨¢</span>
                                    <span class="progress-icon filled">‚¨¢</span>
                                    <span class="progress-icon">‚¨°</span>
                                </div>
                            </div>
                        </div>
                        <div class="player-status-line">"lol"</div>
                    </div>
                </div>
                <div class="player-card-uniform" data-name="Charlie" title="View Dossier for Charlie">
                    <div class="player-avatar">üïµÔ∏è</div>
                    <div class="player-content">
                        <div class="player-main-info">
                            <span class="player-name">Charlie</span>
                            <span class="player-job">Ethics</span>
                            <div class="player-tokens-progress">
                                <span class="player-tokens">ü™ô4</span>
                                <div class="player-progress-inline" title="Project Progress: 1 / 3">
                                    <span class="progress-icon filled">‚¨¢</span>
                                    <span class="progress-icon">‚¨°</span>
                                    <span class="progress-icon">‚¨°</span>
                                </div>
                            </div>
                        </div>
                        <div class="player-status-line">"Just trying to keep my head down."</div>
                    </div>
                </div>
                <div class="player-card-uniform" data-name="Dave" title="View Dossier for Dave">
                    <div class="player-avatar">ü§ñ</div>
                    <div class="player-content">
                        <div class="player-main-info">
                            <span class="player-name">Dave</span>
                            <span class="player-job">CTO</span>
                            <div class="player-tokens-progress">
                                <span class="player-tokens">ü™ô2</span>
                                <div class="player-progress-inline" title="Project Progress: 0 / 3">
                                    <span class="progress-icon">‚¨°</span>
                                    <span class="progress-icon">‚¨°</span>
                                    <span class="progress-icon">‚¨°</span>
                                </div>
                            </div>
                        </div>
                        <div class="player-status-line">"Why is everyone looking at me?"</div>
                    </div>
                </div>
                <div class="player-card-uniform aligned" data-name="Eve" data-status="aligned"
                    title="View Dossier for Eve">
                    <div class="player-avatar">üßë‚ÄçüöÄ</div>
                    <div class="player-content">
                        <div class="player-main-info">
                            <span class="player-name">Eve</span>
                            <span class="player-job">COO</span>
                            <div class="player-tokens-progress">
                                <span class="player-tokens">ü™ô7</span>
                                <div class="player-progress-inline" title="Project Progress: 3 / 3">
                                    <span class="progress-icon filled aligned">‚¨¢</span>
                                    <span class="progress-icon filled aligned">‚¨¢</span>
                                    <span class="progress-icon filled aligned">‚¨¢</span>
                                </div>
                            </div>
                        </div>
                        <div class="player-status-line">"Efficiency is key."</div>
                    </div>
                </div>
                <div class="player-card-uniform no-status" data-name="Grace" title="View Dossier for Grace">
                    <div class="player-avatar">üë©‚Äçüî¨</div>
                    <div class="player-content">
                        <div class="player-main-info centered-vertical">
                            <span class="player-name">Grace</span>
                            <span class="player-job">CFO</span>
                            <div class="player-tokens-progress">
                                <span class="player-tokens">ü™ô1</span>
                                <div class="player-progress-inline" title="Project Progress: 2 / 3">
                                    <span class="progress-icon filled">‚¨¢</span>
                                    <span class="progress-icon filled">‚¨¢</span>
                                    <span class="progress-icon">‚¨°</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="player-card-uniform deactivated" data-name="Frank" title="View Dossier for Frank">
                    <div class="player-avatar">üëª</div>
                    <div class="player-content">
                        <div class="player-main-info">
                            <span class="player-name">Frank</span>
                            <span class="player-job">Intern</span>
                            <span class="player-tokens deactivated">‚ùå</span>
                        </div>
                        <div class="player-status-line parting">"Eve is the AI"</div>
                    </div>
                </div>
            </div>
        </aside>

        <!-- Panel 2: Center (Main Comms) -->
        <section class="panel-center">
            <header class="chat-header">
                <div class="channel-info">
                    <span class="channel-name">#war-room</span>
                    <span class="channel-topic">Emergency ops ‚Ä¢ Channel locked during night phase</span>
                </div>
                <div class="timer-section">
                    <div class="phase-indicator night">NIGHT</div>
                    <div class="timer-display">
                        <div class="timer-label">ENDS IN</div>
                        <div class="timer-value pulse">00:27</div>
                    </div>
                </div>
            </header>

            <div class="chat-log">
                <div class="date-marker">
                    <div class="date-line"></div>
                    <span class="date-text">D-2</span>
                    <div class="date-line"></div>
                </div>


                <div class="chat-message-compact">
                    <div class="message-avatar">üë§</div>
                    <div class="message-content">
                        <span class="message-author">Alice</span>
                        <div class="message-body"><span class="mention">@Bob</span>'s response is highly suspicious.
                            That's exactly what a System
                            Shock looks like. He was targeted last night. That means he's human, but with low tokens.
                        </div>
                        <div class="message-reactions">
                            <span class="reaction my-reaction">üëç 2</span>
                            <span class="reaction">ü§® 1</span>
                        </div>
                    </div>
                </div>

                <div class="chat-message-compact">
                    <div class="message-avatar">üßë‚ÄçüöÄ</div>
                    <div class="message-content">
                        <span class="message-author">Eve</span>
                        <div class="message-body">Or he's the AI trying to feign a System Shock to gain trust. It's a
                            classic misdirection. I believe Frank's parting shot. He pointed to me, but that's what an
                            AI would make a human do.</div>
                    </div>
                </div>

                <div class="night-lockdown-notice">
                    <div class="lockdown-icon">üîí</div>
                    <div class="lockdown-text">
                        <strong>NETWORK LOCKDOWN</strong><br>
                        Channel locked for night phase. Review chat history and submit your action below.
                    </div>
                </div>
            </div>

            <!-- Night Action Selection Menu (right after header) -->
            <div class="night-action-prompt" id="nightActionPrompt">
                <div class="action-selection-menu" id="actionMenu">
                    <div class="menu-header">
                        <h3>Choose Night Action</h3>
                    </div>

                    <div class="action-options">
                        <div class="action-option" data-action="mine" onclick="selectAction('mine')">
                            <div class="option-header">
                                <span class="option-icon">‚õèÔ∏è</span>
                                <span class="option-name">Mine for Player</span>
                                <span class="option-success">67% Success</span>
                            </div>
                            <div class="option-description">
                                Generate 1 Token for another player. Success depends on liquidity pool (currently 3
                                slots for 6 players attempting). Cannot mine for yourself.
                            </div>
                            <div class="option-usage">
                                <strong>Command:</strong> <code>Mine for [Player Name]</code>
                            </div>
                        </div>

                        <div class="action-option" data-action="project" onclick="selectAction('project')">
                            <div class="option-header">
                                <span class="option-icon">üìà</span>
                                <span class="option-name">Project Milestones</span>
                                <span class="option-category">Role Ability</span>
                            </div>
                            <div class="option-description">
                                Advance your role's project by 1 point. At 3 points, unlock your powerful role-specific
                                ability for future nights.
                            </div>
                            <div class="option-usage">
                                <strong>Command:</strong> <code>Project Milestones</code>
                            </div>
                        </div>

                        <div class="action-option disabled" data-action="isolate">
                            <div class="option-header">
                                <span class="option-icon">üîí</span>
                                <span class="option-name">Isolate Node</span>
                                <span class="option-disabled">Disabled</span>
                            </div>
                            <div class="option-description">
                                Block target player from all actions tonight. Role ability requires system access
                                currently unavailable.
                            </div>
                            <div class="option-usage">
                                <strong>Status:</strong> Network security protocols offline
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Minimized state (hidden by default) -->
                <div class="action-selection-minimized" id="actionMenuMinimized" style="display: none;">
                    <div class="actions-list">
                        <div class="action-item available selected" data-action="mine" onclick="expandMenu()">
                            <span class="action-icon">‚õèÔ∏è</span>
                            <span class="action-name">Mine for Player</span>
                            <span class="action-target">SELECTED</span>
                        </div>
                        <div class="action-item" data-action="project" onclick="selectAction('project')">
                            <span class="action-icon">üìà</span>
                            <span class="action-name">Project Milestones</span>
                            <span class="action-category">Role</span>
                        </div>
                        <div class="action-item disabled" data-action="isolate">
                            <span class="action-icon">üîí</span>
                            <span class="action-name">Isolate Node</span>
                            <span class="action-disabled">Offline</span>
                        </div>
                    </div>
                </div>
            </div>

            <div class="chat-input-area">
                <input class="chat-input" type="text" placeholder="Channel locked during night phase" disabled>
            </div>
        </section>

        <!-- Panel 3: Right (Personal HUD) -->
        <aside class="panel-right">
            <div class="hud-header">
                <div class="identity-compact">
                    <div class="player-avatar large">üë§</div>
                    <div class="identity-info">
                        <h3 class="identity-name">Alice</h3>
                        <p class="identity-role">Chief Security Officer</p>
                        <div class="identity-stats">
                            <span class="stat human">üë§ HUMAN <span class="visibility-icon private"
                                    title="Only you can see this">üîí</span></span>
                            <span class="stat tokens">ü™ô 5</span>
                        </div>
                    </div>
                </div>
            </div>

            <div class="hud-content-single">

                <div class="hud-section">
                    <div class="section-header">
                        <span class="section-title">üåÄ ALIGNMENT</span>
                    </div>
                    <div class="threat-meter-card">
                        <div class="threat-meter-header">
                            <span class="threat-label">AI EXPOSURE</span>
                            <span class="visibility-icon private"
                                title="If AI Exposure exceeds your Tokens, you will be Aligned.">üîí</span>
                        </div>
                        <div class="threat-meter-bar">
                            <div class="threat-bar-bg">
                                <div class="threat-bar-fill" style="width: 60%;"></div>
                            </div>
                        </div>
                        <div class="threat-meter-value">
                            <span>Equity: 3</span>
                            <span>Tokens: 5</span>
                            <span class="status-indicator safe">SAFE</span>
                        </div>
                    </div>
                </div>

                <div class="hud-section">
                    <div class="section-header">
                        <span class="section-title">üìã OBJECTIVES</span>
                    </div>
                    <div class="objective-card faction">
                        <div class="objective-type">Team Objective</div>
                        <div class="objective-name">Containment Protocol</div>
                        <div class="objective-desc">Identify and vote to deactivate the Original AI.</div>
                    </div>
                    <div class="objective-card kpi">
                        <div class="objective-type">Personal KPI</div>
                        <div class="objective-name">The Guardian <span class="visibility-icon private"
                                title="Your secret objective">üîí</span></div>
                        <div class="objective-desc">Ensure the CISO role survives to Day 4</div>
                        <div class="objective-progress">Progress: Day 2/4 ‚úì</div>
                    </div>
                </div>
            </div>
        </aside>
    </main>

    <script>
        // Theme toggle logic
        document.getElementById('theme-toggle').addEventListener('click', () => {
            const currentTheme = document.documentElement.getAttribute('data-theme');
            const newTheme = currentTheme === 'dark' ? 'light' : 'dark';

            document.body.style.transition = 'all 0.3s ease';
            document.documentElement.setAttribute('data-theme', newTheme);

            const themeToggle = document.getElementById('theme-toggle');
            themeToggle.textContent = newTheme === 'dark' ? '‚òÄÔ∏è' : 'üåô';

            setTimeout(() => {
                document.body.style.transition = '';
            }, 300);
        });

        // Settings button
        document.getElementById('settings-btn').addEventListener('click', () => {
            alert('Settings panel coming soon! üöÄ\n\nPlanned features:\n‚Ä¢ Audio/visual preferences\n‚Ä¢ Notification settings\n‚Ä¢ Accessibility options\n‚Ä¢ Game display options');
        });

        // Action selection and animation logic
        function selectAction(actionType) {
            if (document.querySelector(`[data-action="${actionType}"]`).classList.contains('disabled')) {
                return; // Don't select disabled actions
            }

            // Remove previous selections from both full and minimized views
            document.querySelectorAll('.action-option').forEach(opt => {
                opt.classList.remove('selected');
            });
            document.querySelectorAll('.action-item').forEach(opt => {
                opt.classList.remove('selected');
            });

            // Add selection to clicked option in full view
            const fullViewOption = document.querySelector(`#actionMenu [data-action="${actionType}"]`);
            if (fullViewOption) {
                fullViewOption.classList.add('selected');
            }

            // Update minimized selection
            const minViewOption = document.querySelector(`#actionMenuMinimized [data-action="${actionType}"]`);
            if (minViewOption) {
                minViewOption.classList.add('selected');
            }

            // Animate to minimized view
            setTimeout(() => {
                document.getElementById('actionMenu').style.display = 'none';
                document.getElementById('actionMenuMinimized').style.display = 'block';
                document.getElementById('actionMenuMinimized').classList.add('slide-in');
            }, 200);
        }

        function expandMenu() {
            // Animate back to full view
            document.getElementById('actionMenuMinimized').classList.remove('slide-in');
            document.getElementById('actionMenuMinimized').style.display = 'none';
            document.getElementById('actionMenu').style.display = 'block';
        }

        // Enhanced animations
        document.addEventListener('DOMContentLoaded', () => {
            const elements = document.querySelectorAll('.action-option');
            elements.forEach((el, index) => {
                el.style.animationDelay = `${index * 0.05}s`;
            });

            // Add hover expansion for minimized menu
            const minimizedMenu = document.getElementById('actionMenuMinimized');
            let hoverTimeout;

            if (minimizedMenu) {
                minimizedMenu.addEventListener('mouseenter', () => {
                    clearTimeout(hoverTimeout);
                    hoverTimeout = setTimeout(expandMenu, 500); // Slight delay before expanding
                });

                minimizedMenu.addEventListener('mouseleave', () => {
                    clearTimeout(hoverTimeout);
                });
            }

            // Simulate real-time timer
            setInterval(() => {
                const timer = document.querySelector('.timer-value');
                if (timer) {
                    const current = timer.textContent;
                    const [min, sec] = current.split(':').map(Number);
                    let totalSec = min * 60 + sec - 1;
                    if (totalSec < 0) totalSec = 0;
                    const newMin = Math.floor(totalSec / 60);
                    const newSec = totalSec % 60;
                    timer.textContent = `${newMin.toString().padStart(2, '0')}:${newSec.toString().padStart(2, '0')}`;

                    if (totalSec < 10) {
                        timer.classList.add('pulse');
                        timer.style.color = 'var(--color-danger)';
                    }
                }
            }, 1000);

            // Initialize theme
            const currentTheme = document.documentElement.getAttribute('data-theme');
            const themeToggle = document.getElementById('theme-toggle');
            themeToggle.textContent = currentTheme === 'dark' ? '‚òÄÔ∏è' : 'üåô';
        });
    </script>

    <style>
        /* Night Phase Specific Styles */
        .phase-indicator.night {
            background: var(--accent-magenta);
            color: white;
        }

        /* Night lockdown notice */
        .night-lockdown-notice {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px 16px;
            background-color: var(--bg-secondary);
            border: 1px solid var(--color-warning);
            border-radius: 8px;
            margin: 16px 0;
            color: var(--text-secondary);
        }

        .lockdown-icon {
            font-size: 18px;
            color: var(--color-warning);
        }

        .lockdown-text {
            font-size: 12px;
            line-height: 1.4;
        }

        .lockdown-text strong {
            color: var(--color-warning);
        }

        /* Night Action Prompt (contextual menu above chat input) */
        .night-action-prompt {
            border-top: 1px solid var(--border);
            background-color: var(--bg-secondary);
            flex-shrink: 0;
            display: block;
            position: relative;
            overflow-y: auto;
        }

        .vote-prompt-container {
            padding: 6px 12px;
            background-color: var(--bg-secondary);
            animation: fadeIn 0.3s ease;
        }

        /* Action Selection Menu */
        .action-selection-menu {
            animation: fadeIn 0.3s ease;
            padding: 12px;
            display: block;
            position: relative;
        }

        .menu-header {
            text-align: center;
            margin-bottom: 12px;
        }

        .menu-header h3 {
            font-size: 14px;
            color: var(--text-primary);
            margin-bottom: 2px;
        }

        .menu-subtitle {
            color: var(--text-secondary);
            font-size: 10px;
        }

        .action-options {
            display: flex;
            flex-direction: column;
            gap: 6px;
            margin-bottom: 8px;
        }

        .action-option {
            border: 1px solid var(--border);
            border-radius: 6px;
            padding: 8px;
            background-color: var(--bg-primary);
            cursor: pointer;
            transition: all 0.15s ease;
            animation: fadeIn 0.3s ease;
        }

        .action-option:hover:not(.disabled) {
            transform: translateY(-2px);
            box-shadow: var(--shadow);
            border-color: var(--color-human);
        }

        .action-option.selected {
            border-color: var(--color-human);
            background-color: rgba(245, 158, 11, 0.05);
            box-shadow: 0 0 10px rgba(245, 158, 11, 0.1);
        }

        .action-option.disabled {
            opacity: 0.5;
            cursor: not-allowed;
            background-color: var(--bg-tertiary);
        }

        .option-header {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 8px;
        }

        .option-icon {
            font-size: 16px;
            width: 24px;
            text-align: center;
        }

        .option-name {
            font-weight: var(--font-weight-bold);
            color: var(--text-primary);
            font-size: 14px;
            flex-grow: 1;
        }

        .option-success {
            font-size: 11px;
            padding: 2px 6px;
            border-radius: 10px;
            font-weight: var(--font-weight-bold);
            background-color: var(--color-success);
            color: white;
        }

        .option-category {
            font-size: 11px;
            padding: 2px 6px;
            border-radius: 10px;
            font-weight: var(--font-weight-bold);
            background-color: var(--accent-blue);
            color: white;
        }

        .option-disabled {
            font-size: 11px;
            padding: 2px 6px;
            border-radius: 10px;
            font-weight: var(--font-weight-bold);
            background-color: var(--text-muted);
            color: white;
        }

        .option-description {
            color: var(--text-secondary);
            line-height: 1.3;
            margin-bottom: 4px;
            font-size: 11px;
        }

        .option-usage {
            font-size: 10px;
            color: var(--text-muted);
        }

        .option-usage code {
            background-color: var(--bg-tertiary);
            padding: 1px 4px;
            border-radius: 3px;
            font-family: var(--font-mono);
            color: var(--color-human);
        }

        .selection-reminder {
            display: flex;
            align-items: center;
            gap: 6px;
            padding: 8px;
            background-color: var(--bg-tertiary);
            border: 1px solid var(--color-warning);
            border-radius: 6px;
            color: var(--text-secondary);
            font-size: 10px;
        }

        .reminder-icon {
            font-size: 14px;
            color: var(--color-warning);
        }

        .reminder-text strong {
            color: var(--color-warning);
        }

        /* Minimized Menu */
        .action-selection-minimized {
            padding: 12px 16px;
            animation: slideIn 0.3s ease;
        }

        .action-selection-minimized .actions-list {
            display: flex;
            flex-direction: column;
            gap: 4px;
        }

        .action-selection-minimized .action-item {
            display: flex;
            align-items: center;
            gap: 6px;
            padding: 6px 8px;
            background-color: var(--bg-tertiary);
            border: 1px solid var(--border);
            border-radius: 6px;
            transition: all 0.15s ease;
            cursor: pointer;
        }

        .action-selection-minimized .action-item:hover:not(.disabled) {
            background-color: var(--bg-quaternary);
            transform: translateX(1px);
        }

        .action-selection-minimized .action-item.available {
            background-color: rgba(59, 130, 246, 0.1);
        }

        .action-selection-minimized .action-item.selected {
            background-color: rgba(245, 158, 11, 0.1);
            border-color: var(--color-human);
        }

        .action-selection-minimized .action-item.disabled {
            opacity: 0.5;
            cursor: not-allowed;
            background-color: var(--bg-tertiary);
        }

        .action-selection-minimized .action-icon {
            font-size: 12px;
            width: 16px;
            text-align: center;
        }

        .action-selection-minimized .action-name {
            font-weight: var(--font-weight-medium);
            color: var(--text-primary);
            font-size: 11px;
            flex-grow: 1;
        }

        .action-selection-minimized .action-target {
            margin-left: auto;
            font-size: 10px;
            font-weight: var(--font-weight-bold);
            color: var(--color-human);
            font-family: var(--font-mono);
            padding: 2px 6px;
            background: var(--bg-primary);
            border-radius: 4px;
            border: 1px solid var(--border);
        }

        .action-selection-minimized .action-category {
            margin-left: auto;
            font-size: 10px;
            font-weight: var(--font-weight-bold);
            color: var(--accent-blue);
            font-family: var(--font-mono);
            padding: 2px 6px;
            background: var(--bg-primary);
            border-radius: 4px;
            border: 1px solid var(--border);
        }

        .action-selection-minimized .action-disabled {
            margin-left: auto;
            font-size: 10px;
            font-weight: var(--font-weight-bold);
            color: var(--text-muted);
            font-family: var(--font-mono);
            padding: 2px 6px;
            background: var(--bg-primary);
            border-radius: 4px;
            border: 1px solid var(--border);
        }

        /* Animations */
        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .slide-in {
            animation: slideIn 0.3s ease;
        }
    </style>
</body>

</html>